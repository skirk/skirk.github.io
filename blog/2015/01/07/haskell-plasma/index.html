
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>haskell plasma! - Tuomo's corner</title>
	<meta name="author" content="Tuomo Rinne">

	
	<meta name="description" content="On my Haskell journey and I decided to tackle plasma effect (explained here) 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
-- Create color for a Cell
makecolor &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Tuomo's corner" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--  -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- Load jQuery -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
	jQuery.noConflict(); // ender.js conflicts with jQuery
</script>
<!-- Load FancyBox -->
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" />
<script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>
<!-- Fix FancyBox style for OctoPress -->
<style type="text/css">
  .fancybox-wrap { position: fixed !important; }
  .fancybox-opened {
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
  }
  .fancybox-close, .fancybox-prev span, .fancybox-next span {
    background-color: transparent !important;
    border: 0 !important;
  }
</style>

<!-- Custom Scripts -->
<script language="Javascript" type="text/javascript">
	// ender.js gobbles jQuery's ready event: Use ender.js $ instead
	$(document).ready(function() {
		jQuery(".fancybox").fancybox();
	});
</script> 

</head>

<body>
	<div class="container">	

		<div class="mid-col-container">
			<div id="content" class="inner">
				<div class="center"><a href="/"><img src="/images/loading_pacman2.gif"></a><a href="/about">&#8226 About </a><a href="/blog/archives">&#8226 Archive </a><a href="/contact">&#8226 Contact</a></div>
				<article class="post">
	<h1 class="title">Haskell Plasma!</h1>
	<div class="entry-content"><p>On my Haskell journey and I decided to tackle plasma effect (explained <a href="http://www.bidouille.org/prog/plasma">here</a>)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="c1">-- Create color for a Cell</span>
</span><span class='line'><span class="nf">makecolor</span> <span class="n">x</span> <span class="n">y</span> <span class="n">t</span> <span class="ow">=</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span><span class='line'>  <span class="kr">where</span>
</span><span class='line'>  <span class="n">r</span> <span class="ow">=</span> <span class="p">(</span><span class="n">cos</span> <span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.9</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.7</span> <span class="p">)</span>
</span><span class='line'>          <span class="n">g</span> <span class="ow">=</span> <span class="p">(</span><span class="n">sin</span> <span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="p">)</span>
</span><span class='line'>  <span class="n">b</span> <span class="ow">=</span> <span class="mf">0.3</span>
</span><span class='line'>  <span class="n">v</span> <span class="ow">=</span> <span class="n">sin</span><span class="p">(</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">cx</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">cy</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span> <span class="p">)</span>
</span><span class='line'>  <span class="n">cx</span> <span class="ow">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.5</span>
</span><span class='line'>  <span class="n">cy</span> <span class="ow">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.5</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- Draw one Cell or &quot;pixel&quot;</span>
</span><span class='line'><span class="nf">drawCell</span> <span class="n">w</span> <span class="n">h</span> <span class="n">t</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">=</span> <span class="kr">do</span>
</span><span class='line'>  <span class="n">color</span> <span class="o">$</span> <span class="n">makecolor</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">w</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="n">h</span><span class="p">)</span> <span class="n">t</span>
</span><span class='line'>          <span class="kt">C</span><span class="o">.</span><span class="n">rectangle</span> <span class="n">x</span> <span class="n">y</span> <span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span>
</span><span class='line'>  <span class="kt">C</span><span class="o">.</span><span class="n">fill</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>The drawing draw call is super simple. Thanks to list comprehensions!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="c1">-- w h: width and height of canvas, t:time</span>
</span><span class='line'><span class="nf">mapM</span> <span class="p">(</span><span class="n">drawCell</span> <span class="n">w</span> <span class="n">h</span> <span class="n">t</span><span class="p">)</span> <span class="p">[(</span><span class="n">x</span> <span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">0</span><span class="p">,(</span><span class="n">w</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="o">..</span> <span class="n">w</span><span class="p">],</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">0</span><span class="p">,(</span><span class="n">h</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="o">..</span> <span class="n">h</span> <span class="p">]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>
In essence the program is just a poor mans fragment shader. The resulting animation is below:</p>

<p><video width="400" height="400" controls>
<source src="/images/post/test.webm" type="video/webm">
Your browser does not support the video tag.
</video></p>
</div>

</article>


			</div>
		</div>
		<footer id="footer" class="inner">
		Copyright &copy; 2015 

    <a href="/about">Tuomo Rinne</a>
 |
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/nologo">noLogo</a> + my own hacks</span>
</footer>
		<script src="/javascripts/slash.js"></script>








	</div>
</body>
</html>
